<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>
      My Winter Car Parts Checklist - Track Your Car Parts Inventory
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Track and manage your car parts inventory for My Winter Car. Check off parts you have and see which ones you're missing for the Corris Rivett, Sorbett, and other vehicles."
    />
    <meta
      name="keywords"
      content="My Winter Car, MWC, My Winter Car parts, car parts checklist, Corris Rivett, Sorbett, car parts tracker, inventory tracker, Amistech Games, ToplessGun, engine assembly, suspension assembly, body assembly, interior assembly, auxiliary assembly, aftermarket parts, car parts list, parts inventory, vehicle parts, automotive parts, car building, car restoration, winter car game, Finnish car game, Peräjärvi, car parts management, parts checklist tool, missing parts tracker, car parts organizer, vehicle inventory, car restoration checklist, engine parts, suspension parts, body parts, interior parts, Jonnez ES, Gifu, Hayosiko, Heppa, Kekmet, EDM 500LX, Victra, Fittan, car parts database"
    />
    <meta name="author" content="Amistech Games" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://mwc-parts-checklist.vercel.app/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="My Winter Car Parts Checklist" />
    <meta
      property="og:description"
      content="Track and manage your car parts inventory for My Winter Car. Check off parts you have and see which ones you're missing."
    />
    <meta property="og:site_name" content="My Winter Car Parts Checklist" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="My Winter Car Parts Checklist" />
    <meta
      name="twitter:description"
      content="Track and manage your car parts inventory for My Winter Car. Check off parts you have and see which ones you're missing."
    />
    <link id="theme-stylesheet" rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <button
        id="css-toggle-btn"
        type="button"
        style="
          position: absolute;
          top: 10px;
          right: 10px;
          padding: 4px 8px;
          font-size: 12px;
          cursor: pointer;
          z-index: 1000;
        "
      >
        Switch to 90s Style
      </button>
      <header>
        <div class="title-row">
          <h1>My Winter Car Parts Checklist</h1>
          <span class="chip"
            >Engine · Suspension · Body · Interior · Aftermarket</span
          >
        </div>
        <p>
          Toggle each part to track whether you already have it. The summary
          below always reflects which parts you have on hand and which ones are
          still missing.
        </p>
      </header>

      <main class="layout">
        <section class="panel">
          <div class="panel-header">
            <div>
              <h2>Parts Inventory</h2>
              <div class="panel-sub">
                Grouped by assembly · Click titles to collapse
              </div>
            </div>
            <div class="panel-actions">
              <div class="filter-group" aria-label="Filter visible parts">
                <button
                  class="filter-btn active"
                  data-filter="all"
                  type="button"
                >
                  All
                </button>
                <button class="filter-btn" data-filter="have" type="button">
                  Have
                </button>
                <button class="filter-btn" data-filter="missing" type="button">
                  Missing
                </button>
              </div>
              <button
                id="reset-all"
                class="reset-btn"
                type="button"
                title="Clear all selections"
              >
                Reset
              </button>
            </div>
          </div>
          <div class="search-container">
            <input
              type="text"
              id="search-input"
              class="search-input"
              placeholder="Search parts by name..."
              aria-label="Search parts by name"
            />
          </div>
          <div
            id="categories"
            class="categories"
            aria-label="Car parts checklist"
          ></div>
        </section>

        <aside class="panel">
          <div class="summary-header">
            <div>
              <h2>Summary</h2>
              <div class="panel-sub">
                Live breakdown of owned vs missing parts
              </div>
            </div>
          </div>

          <section class="summary-main" aria-live="polite">
            <div class="summary-metrics">
              <div class="metric">
                <div class="metric-label">Total Parts</div>
                <div id="total-count" class="metric-value">0</div>
              </div>
              <div class="metric badge-have">
                <div class="metric-label">Have</div>
                <div id="have-count" class="metric-value">0</div>
              </div>
              <div class="metric badge-missing">
                <div class="metric-label">Missing</div>
                <div id="missing-count" class="metric-value">0</div>
              </div>
            </div>

            <div class="lists">
              <div class="list-card">
                <div class="list-header">
                  <span class="list-title">Parts I Have</span>
                  <span class="tag">
                    <span class="tag-dot-have"></span>
                    Have
                  </span>
                </div>
                <div id="have-list-count" class="list-count">0 items</div>
                <div id="have-list" class="list-body">
                  <div class="list-empty">No parts selected yet.</div>
                </div>
              </div>

              <div class="list-card">
                <div class="list-header">
                  <span class="list-title">Parts I Am Missing</span>
                  <span class="tag">
                    <span class="tag-dot-missing"></span>
                    Missing
                  </span>
                </div>
                <div id="missing-list-count" class="list-count">0 items</div>
                <div id="missing-list" class="list-body">
                  <div class="list-empty">
                    All parts are currently marked as missing.
                  </div>
                </div>
              </div>
            </div>
          </section>
        </aside>
      </main>
    </div>

    <script>
      // Data model: categories and parts
      const PART_CATEGORIES = [
        {
          name: 'ENGINE ASSEMBLY',
          parts: [
            'Air filter',
            'Alternator',
            'Aux Shaft',
            'Aux Sprocket',
            'Block',
            'Brake Cylinder',
            'Camshaft',
            'Camshaft Sprocket',
            'Carburetor',
            'Clutch Cover Plate',
            'Clutch Disk',
            'Crankshaft',
            'Crankshaft Pulley',
            'Cylinder Head',
            'Distributor',
            'Exhaust Manifold',
            'Fan',
            'Fan Belt',
            'Flywheel',
            'Fuel Pump',
            'Gearbox',
            'Headgasket',
            'Intake Manifold',
            'Main Bearings',
            'Oilpan',
            'Pistons',
            'Pressure Plate',
            'Rear Plate',
            'Rocker Arm',
            'Rocker Cover',
            'Starter',
            'Thermostat Housing',
            'Timing Belt',
            'Timing belt Cover',
            'Vacuum Line',
            'Water Pump',
            'Water Pump Pulley'
          ]
        },
        {
          name: 'AUXILLARY ASSEMBLY',
          parts: [
            'Battery',
            'Brake Lining',
            'Brake Master Cylinder',
            'Blower Hose',
            'Clutch Cable',
            'Exhaust Pipe Front',
            'Exhaust Pipe Rear',
            'Fuel Tank',
            'Handbrake Cable',
            'Heater Box',
            'Heater Hose Inlet',
            'Heater Hose Outlet',
            'Ignition Coil',
            'Oil Pump',
            'Thermostat',
            'Power Brake Cylinder',
            'Radiator',
            'Radiator Hose Bottom',
            'Radiator Hose Top',
            'Steering Column',
            'Steering Rack',
            'Steering Shaft'
          ]
        },
        {
          name: 'SUSPENSION ASSEMBLY',
          parts: [
            'Brake Assembly Right',
            'Brake Assembly Left',
            'Coil Spring',
            'Driveshaft',
            'Front Link Left',
            'Front Link Right',
            'Front Lower Control Arm',
            'Front Upper Control Arm',
            'Rear Axle',
            'Rear Lower Control Arm',
            'Rear Upper Control Arm',
            'Shock Absorber Front',
            'Shock Absorber Rear',
            'Wheels'
          ]
        },
        {
          name: 'BODY ASSEMBLY',
          parts: [
            'Bootlid',
            'Bumper Front',
            'Bumper Rear',
            'Door Left',
            'Door Right',
            'Fender Left',
            'Fender Right',
            'Grille',
            'Headlight Left',
            'Headlight Right',
            'Hood',
            'Hubcaps',
            'Rear Light Left',
            'Rear Light Right'
          ]
        },
        {
          name: 'INTERIOR ASSEMBLY',
          parts: [
            'Column Shroud Left',
            'Column Shroud Right',
            'Dashboard',
            'Dashboard Bottom Cover',
            'Dashboard Top Cover',
            'Fresh Air Duct',
            'Gear Lever',
            'Handbrake Lever',
            'Instrument Panel',
            'Manual/Automatic Pedal Box',
            'Parcel Shelf',
            'Radio',
            'Rear Seat Backrest',
            'Rear Seat Bench',
            'Seat Driver',
            'Seat Passenger',
            'Steering Wheel',
            'Ventilation Box'
          ]
        },
        {
          name: 'AFTERMARKET PARTS',
          parts: [
            'Ampere Gauge',
            'Extra Gauges',
            'Long Coil Springs',
            'Nitrous',
            'Rally Mudflaps',
            'Rear Spoiler',
            'Short Coil Springs',
            'Skid Plate',
            'Twin Carburators'
          ]
        }
      ];

      // State: map partId -> boolean (true = have, false = missing)
      const partState = {};
      const PART_ID_PREFIX = 'part-';
      const STORAGE_KEY = 'carPartsChecklistState.v1';

      function createPartId(categoryName, partName) {
        return (
          PART_ID_PREFIX +
          categoryName.replace(/\s+/g, '_') +
          '-' +
          partName.replace(/[^\w]+/g, '_')
        ).toLowerCase();
      }

      function loadStateFromStorage() {
        try {
          const raw = window.localStorage.getItem(STORAGE_KEY);
          if (!raw) return;
          const parsed = JSON.parse(raw);
          if (!parsed || typeof parsed !== 'object') return;
          Object.keys(parsed).forEach(id => {
            partState[id] = Boolean(parsed[id]);
          });
        } catch (error) {
          // If anything goes wrong (including file:// quirks), just ignore and start fresh
          console.warn('Could not load saved car parts state', error);
        }
      }

      function saveStateToStorage() {
        try {
          window.localStorage.setItem(STORAGE_KEY, JSON.stringify(partState));
        } catch (error) {
          // Non-fatal; the UI still works even if persistence fails
          console.warn('Could not save car parts state', error);
        }
      }

      function renderCategories() {
        const container = document.getElementById('categories');
        container.innerHTML = '';

        PART_CATEGORIES.forEach(category => {
          const categoryEl = document.createElement('section');
          categoryEl.className = 'category';

          const header = document.createElement('button');
          header.type = 'button';
          header.className = 'category-header';
          header.setAttribute('aria-expanded', 'true');

          const titleBlock = document.createElement('div');
          titleBlock.className = 'category-title-block';

          const nameEl = document.createElement('div');
          nameEl.className = 'category-name';
          nameEl.textContent = category.name;

          const countEl = document.createElement('div');
          countEl.className = 'category-count';
          countEl.textContent = `${category.parts.length} parts`;

          titleBlock.appendChild(nameEl);
          titleBlock.appendChild(countEl);

          const chevron = document.createElement('div');
          chevron.className = 'chevron';
          chevron.textContent = '▾';

          header.appendChild(titleBlock);
          header.appendChild(chevron);

          const partsList = document.createElement('div');
          partsList.className = 'parts';

          category.parts.forEach(partName => {
            const partId = createPartId(category.name, partName);
            if (!(partId in partState)) {
              partState[partId] = false; // default missing
            }

            const row = document.createElement('div');
            row.className = 'part-row missing';
            row.dataset.partId = partId;
            row.setAttribute('role', 'button');
            row.setAttribute('tabindex', '0');
            row.setAttribute(
              'aria-label',
              `Toggle "${partName}" - Click to mark as have or missing`
            );

            const label = document.createElement('div');
            label.className = 'part-label';

            const dot = document.createElement('div');
            dot.className = 'part-dot';

            const nameSpan = document.createElement('div');
            nameSpan.className = 'part-name';
            nameSpan.textContent = partName;

            const statusPill = document.createElement('span');
            statusPill.className = 'status-pill';
            statusPill.textContent = 'Missing';

            label.appendChild(dot);
            label.appendChild(nameSpan);

            const toggleWrapper = document.createElement('div');
            toggleWrapper.className = 'toggle-wrapper';

            const toggleLabel = document.createElement('span');
            toggleLabel.className = 'toggle-label';
            toggleLabel.textContent = 'Have';

            const switchBtn = document.createElement('button');
            switchBtn.type = 'button';
            switchBtn.className = 'switch';
            switchBtn.setAttribute('role', 'switch');
            switchBtn.setAttribute('aria-checked', 'false');
            switchBtn.dataset.state = 'off';
            switchBtn.dataset.partId = partId;
            switchBtn.setAttribute(
              'aria-label',
              `Mark "${partName}" as have or missing`
            );

            const thumb = document.createElement('div');
            thumb.className = 'switch-thumb';
            switchBtn.appendChild(thumb);

            switchBtn.addEventListener('click', event => {
              event.stopPropagation(); // Prevent row click from firing
              const newState = !partState[partId];
              setPartState(
                partId,
                partName,
                row,
                switchBtn,
                statusPill,
                newState
              );
            });

            switchBtn.addEventListener('keydown', event => {
              if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                switchBtn.click();
              }
            });

            toggleWrapper.appendChild(toggleLabel);
            toggleWrapper.appendChild(switchBtn);

            row.appendChild(label);
            row.appendChild(statusPill);
            row.appendChild(toggleWrapper);

            // Make entire row clickable to toggle
            const toggleRow = () => {
              const newState = !partState[partId];
              setPartState(
                partId,
                partName,
                row,
                switchBtn,
                statusPill,
                newState
              );
            };

            row.addEventListener('click', toggleRow);

            row.addEventListener('keydown', event => {
              if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                toggleRow();
              }
            });

            // Apply any saved state so the UI reflects previously toggled values
            if (partState[partId]) {
              row.classList.remove('missing');
              row.classList.add('have');
              switchBtn.dataset.state = 'on';
              switchBtn.setAttribute('aria-checked', 'true');
              statusPill.textContent = 'Have';
            }

            partsList.appendChild(row);
          });

          header.addEventListener('click', () => {
            const isCollapsed = categoryEl.classList.toggle('collapsed');
            header.setAttribute('aria-expanded', String(!isCollapsed));
          });

          categoryEl.appendChild(header);
          categoryEl.appendChild(partsList);
          container.appendChild(categoryEl);
        });
      }

      function setPartState(
        partId,
        partName,
        rowEl,
        switchEl,
        statusPillEl,
        have
      ) {
        partState[partId] = have;

        if (have) {
          rowEl.classList.remove('missing');
          rowEl.classList.add('have');
          switchEl.dataset.state = 'on';
          switchEl.setAttribute('aria-checked', 'true');
          statusPillEl.textContent = 'Have';
        } else {
          rowEl.classList.remove('have');
          rowEl.classList.add('missing');
          switchEl.dataset.state = 'off';
          switchEl.setAttribute('aria-checked', 'false');
          statusPillEl.textContent = 'Missing';
        }

        applyFilterToRow(rowEl);
        updateSummary();
        saveStateToStorage();
      }

      function getActiveFilter() {
        const active = document.querySelector('.filter-btn.active');
        return active ? active.dataset.filter : 'all';
      }

      function getSearchQuery() {
        const searchInput = document.getElementById('search-input');
        return searchInput ? searchInput.value.trim().toLowerCase() : '';
      }

      function partNameMatchesSearch(partName, searchQuery) {
        if (!searchQuery) return true;
        return partName.toLowerCase().includes(searchQuery);
      }

      function applyFilterToRow(rowEl) {
        const filter = getActiveFilter();
        const searchQuery = getSearchQuery();
        const partNameEl = rowEl.querySelector('.part-name');
        const partName = partNameEl ? partNameEl.textContent : '';
        const matchesSearch = partNameMatchesSearch(partName, searchQuery);

        if (!matchesSearch) {
          rowEl.style.display = 'none';
          return;
        }

        if (filter === 'all') {
          rowEl.style.display = '';
          return;
        }
        const isHave = rowEl.classList.contains('have');
        if (filter === 'have') {
          rowEl.style.display = isHave ? '' : 'none';
        } else if (filter === 'missing') {
          rowEl.style.display = !isHave ? '' : 'none';
        }
      }

      function applyFilterToAll() {
        const rows = document.querySelectorAll('.part-row');
        rows.forEach(row => applyFilterToRow(row));
      }

      function setupFilters() {
        const buttons = document.querySelectorAll('.filter-btn');
        buttons.forEach(btn => {
          btn.addEventListener('click', () => {
            buttons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            applyFilterToAll();
          });
        });

        const searchInput = document.getElementById('search-input');
        if (searchInput) {
          searchInput.addEventListener('input', () => {
            applyFilterToAll();
          });
        }

        const resetButton = document.getElementById('reset-all');
        if (resetButton) {
          resetButton.addEventListener('click', () => {
            // Reset in-memory state
            Object.keys(partState).forEach(id => {
              partState[id] = false;
            });

            // Reset all rows and switches visually
            const rows = document.querySelectorAll('.part-row');
            rows.forEach(row => {
              row.classList.remove('have');
              row.classList.add('missing');
              const partId = row.dataset.partId;
              const switchEl = row.querySelector('.switch');
              const statusPillEl = row.querySelector('.status-pill');
              if (switchEl) {
                switchEl.dataset.state = 'off';
                switchEl.setAttribute('aria-checked', 'false');
              }
              if (statusPillEl) {
                statusPillEl.textContent = 'Missing';
              }
            });

            // Persist cleared state and refresh summary/filter
            saveStateToStorage();
            applyFilterToAll();
            updateSummary();
          });
        }
      }

      function updateSummary() {
        const allIds = Object.keys(partState);
        const total = allIds.length;
        const haveIds = allIds.filter(id => partState[id]);
        const missingIds = allIds.filter(id => !partState[id]);

        const totalCountEl = document.getElementById('total-count');
        const haveCountEl = document.getElementById('have-count');
        const missingCountEl = document.getElementById('missing-count');

        totalCountEl.textContent = String(total);
        haveCountEl.textContent = String(haveIds.length);
        missingCountEl.textContent = String(missingIds.length);

        const haveListEl = document.getElementById('have-list');
        const missingListEl = document.getElementById('missing-list');
        const haveListCountEl = document.getElementById('have-list-count');
        const missingListCountEl =
          document.getElementById('missing-list-count');

        haveListEl.innerHTML = '';
        missingListEl.innerHTML = '';

        if (haveIds.length === 0) {
          const empty = document.createElement('div');
          empty.className = 'list-empty';
          empty.textContent = 'No parts selected yet.';
          haveListEl.appendChild(empty);
        } else {
          haveIds
            .map(id => findPartDisplayNameById(id))
            .sort((a, b) => a.localeCompare(b))
            .forEach(name => {
              const item = document.createElement('div');
              item.className = 'list-item';
              const bullet = document.createElement('div');
              bullet.className = 'list-bullet';
              const text = document.createElement('div');
              text.textContent = name;
              item.appendChild(bullet);
              item.appendChild(text);
              haveListEl.appendChild(item);
            });
        }

        if (missingIds.length === 0) {
          const empty = document.createElement('div');
          empty.className = 'list-empty';
          empty.textContent = 'No parts are missing. Nice work.';
          missingListEl.appendChild(empty);
        } else {
          missingIds
            .map(id => findPartDisplayNameById(id))
            .sort((a, b) => a.localeCompare(b))
            .forEach(name => {
              const item = document.createElement('div');
              item.className = 'list-item';
              const bullet = document.createElement('div');
              bullet.className = 'list-bullet';
              const text = document.createElement('div');
              text.textContent = name;
              item.appendChild(bullet);
              item.appendChild(text);
              missingListEl.appendChild(item);
            });
        }

        haveListCountEl.textContent =
          haveIds.length === 1 ? '1 item' : `${haveIds.length} items`;
        missingListCountEl.textContent =
          missingIds.length === 1 ? '1 item' : `${missingIds.length} items`;
      }

      function findPartDisplayNameById(partId) {
        for (const category of PART_CATEGORIES) {
          for (const partName of category.parts) {
            const candidateId = createPartId(category.name, partName);
            if (candidateId === partId) {
              return partName;
            }
          }
        }
        return partId;
      }

      document.addEventListener('DOMContentLoaded', () => {
        loadStateFromStorage();
        renderCategories();
        setupFilters();
        applyFilterToAll();
        updateSummary();
        setupCSSToggle();
      });

      // CSS Toggle Functionality
      function setupCSSToggle() {
        const toggleBtn = document.getElementById('css-toggle-btn');
        const stylesheet = document.getElementById('theme-stylesheet');

        // Load saved preference from localStorage
        const savedStyle = localStorage.getItem('selectedStyle') || 'style.css';
        stylesheet.href = savedStyle;
        updateButtonText(savedStyle);

        toggleBtn.addEventListener('click', () => {
          const currentHref = stylesheet.href;
          const newHref = currentHref.includes('style90.css')
            ? 'style.css'
            : 'style90.css';

          stylesheet.href = newHref;
          localStorage.setItem('selectedStyle', newHref);
          updateButtonText(newHref);
        });

        function updateButtonText(href) {
          toggleBtn.textContent = href.includes('style90.css')
            ? 'Switch to Modern Style'
            : 'Switch to 90s Style';
        }
      }
    </script>
  </body>
</html>
